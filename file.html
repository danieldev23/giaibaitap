
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMM Marketing Optimization</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        
        .content {
            padding: 30px;
        }
        
        .problem-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 5px solid #3498db;
        }
        
        .table-container {
            overflow-x: auto;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }
        
        th, td {
            padding: 15px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }
        
        th {
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            color: white;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        tr:hover {
            background-color: #f5f5f5;
        }
        
        .input-section {
            background: #fff;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .input-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .input-field {
            display: flex;
            flex-direction: column;
        }
        
        .input-field label {
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .input-field input {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .input-field input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        
        .btn {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            margin: 10px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(52, 152, 219, 0.3);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
        }
        
        .btn-success:hover {
            box-shadow: 0 8px 15px rgba(39, 174, 96, 0.3);
        }
        
        .results {
            background: #e8f5e8;
            border: 2px solid #27ae60;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .results h3 {
            color: #27ae60;
            margin-top: 0;
        }
        
        .solution-table {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            margin-top: 15px;
        }
        
        .highlight {
            background-color: #fff3cd !important;
            border-color: #ffeaa7 !important;
        }
        
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 10px;
            }
            
            .content {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .input-group {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ SMM Marketing Optimization</h1>
            <p>T·ªëi ∆∞u h√≥a chi·∫øn l∆∞·ª£c truy·ªÅn th√¥ng v·ªõi Linear Programming</p>
        </div>
        
        <div class="content">
            <div class="problem-section">
                <h2>üìã ƒê·ªÅ B√†i: Case 3 - L·ª±a Ch·ªçn Ph∆∞∆°ng Ti·ªán Truy·ªÅn Th√¥ng</h2>
                <p><strong>M·ª•c ti√™u:</strong> C√¥ng ty SMM c·∫ßn ch·ªçn ph∆∞∆°ng ti·ªán qu·∫£ng c√°o ƒë·ªÉ ƒë·∫°t t·ªëi thi·ªÉu 11 tri·ªáu l∆∞·ª£t ti·∫øp c·∫≠n v·ªõi chi ph√≠ t·ªëi ∆∞u.</p>
                
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Lo·∫°i h√¨nh qu·∫£ng c√°o</th>
                                <th>L∆∞·ª£ng kh√°n gi·∫£ m·ªóc tinh (l∆∞·ª£t)</th>
                                <th>Chi ph√≠ cho m·ªói lo·∫°i ($)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>B·∫£n ng√†y</strong></td>
                                <td>3000</td>
                                <td>$5,000</td>
                            </tr>
                            <tr>
                                <td><strong>Tin chi·ªÅu (b)</strong></td>
                                <td>4000</td>
                                <td>$7000</td>
                            </tr>
                            <tr>
                                <td><strong>Game Ch·ªß nh·∫≠t</strong></td>
                                <td>7500</td>
                                <td>$100,000</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div style="background: #fff; padding: 15px; border-radius: 8px; margin-top: 15px;">
                    <h4>üìù R√†ng bu·ªôc:</h4>
                    <ul>
                        <li>T·ªëi thi·ªÉu <strong>11,000,000</strong> l∆∞·ª£t ti·∫øp c·∫≠n</li>
                        <li>T·ªëi ƒëa 10 qu·∫£ng c√°o b·∫£n ng√†y v√† 6 qu·∫£ng c√°o tin chi·ªÅu</li>
                        <li>M·ªói tu·∫ßn t·ªëi ƒëa 5 qu·∫£ng c√°o Game Ch·ªß nh·∫≠t</li>
                    </ul>
                </div>
            </div>

            <div class="input-section">
                <h3>üéØ Gi·∫£i Quy·∫øt B√†i To√°n T·ªëi ∆Øu</h3>
                
                <div class="input-group">
                    <div class="input-field">
                        <label>B·∫£n ng√†y (x‚ÇÅ)</label>
                        <input type="number" id="x1" min="0" max="10" step="1" value="0">
                        <small>T·ªëi ƒëa: 10</small>
                    </div>
                    <div class="input-field">
                        <label>Tin chi·ªÅu (x‚ÇÇ)</label>
                        <input type="number" id="x2" min="0" max="6" step="1" value="0">
                        <small>T·ªëi ƒëa: 6</small>
                    </div>
                    <div class="input-field">
                        <label>Game Ch·ªß nh·∫≠t (x‚ÇÉ)</label>
                        <input type="number" id="x3" min="0" max="5" step="1" value="0">
                        <small>T·ªëi ƒëa: 5</small>
                    </div>
                </div>

                <button class="btn" onclick="calculateOptimal()">üîç T√≠nh To√°n T·ªëi ∆Øu</button>
                <button class="btn" onclick="findOptimalSolution()">‚ö° T√¨m Nghi·ªám T·ªëi ∆Øu</button>
                <button class="btn btn-success" onclick="exportToExcel()">üìä Xu·∫•t File Excel</button>
            </div>

            <div id="results" style="display: none;"></div>

            <div class="table-container">
                <table id="calculationTable">
                    <thead>
                        <tr>
                            <th>x‚ÇÅ (B·∫£n ng√†y)</th>
                            <th>x‚ÇÇ (Tin chi·ªÅu)</th>
                            <th>x‚ÇÉ (Game CN)</th>
                            <th>T·ªïng l∆∞·ª£t ti·∫øp c·∫≠n</th>
                            <th>T·ªïng chi ph√≠ ($)</th>
                            <th>ƒê·∫°t y√™u c·∫ßu?</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // D·ªØ li·ªáu b√†i to√°n
        const adTypes = [
            { name: 'B·∫£n ng√†y', reach: 3000, cost: 5000, max: 10 },
            { name: 'Tin chi·ªÅu', reach: 4000, cost: 7000, max: 6 },
            { name: 'Game Ch·ªß nh·∫≠t', reach: 7500, cost: 100000, max: 5 }
        ];
        
        const minReach = 11000000;
        let optimalSolution = null;
        let allSolutions = [];

        function calculateCurrent() {
            const x1 = parseInt(document.getElementById('x1').value) || 0;
            const x2 = parseInt(document.getElementById('x2').value) || 0;
            const x3 = parseInt(document.getElementById('x3').value) || 0;
            
            const totalReach = x1 * adTypes[0].reach + x2 * adTypes[1].reach + x3 * adTypes[2].reach;
            const totalCost = x1 * adTypes[0].cost + x2 * adTypes[1].cost + x3 * adTypes[2].cost;
            
            return { x1, x2, x3, totalReach, totalCost };
        }

        function calculateOptimal() {
            const current = calculateCurrent();
            const tableBody = document.getElementById('tableBody');
            
            const row = `
                <tr class="highlight">
                    <td>${current.x1}</td>
                    <td>${current.x2}</td>
                    <td>${current.x3}</td>
                    <td>${current.totalReach.toLocaleString()}</td>
                    <td>$${current.totalCost.toLocaleString()}</td>
                    <td>${current.totalReach >= minReach ? '‚úÖ ƒê·∫°t' : '‚ùå Kh√¥ng ƒë·∫°t'}</td>
                </tr>
            `;
            
            tableBody.innerHTML = row + tableBody.innerHTML;
        }

        function findOptimalSolution() {
            let bestSolution = null;
            let minCost = Infinity;
            allSolutions = [];

            // Duy·ªát qua t·∫•t c·∫£ c√°c kh·∫£ nƒÉng
            for (let x1 = 0; x1 <= adTypes[0].max; x1++) {
                for (let x2 = 0; x2 <= adTypes[1].max; x2++) {
                    for (let x3 = 0; x3 <= adTypes[2].max; x3++) {
                        const totalReach = x1 * adTypes[0].reach + x2 * adTypes[1].reach + x3 * adTypes[2].reach;
                        const totalCost = x1 * adTypes[0].cost + x2 * adTypes[1].cost + x3 * adTypes[2].cost;
                        
                        const solution = { x1, x2, x3, totalReach, totalCost };
                        allSolutions.push(solution);
                        
                        if (totalReach >= minReach && totalCost < minCost) {
                            minCost = totalCost;
                            bestSolution = solution;
                        }
                    }
                }
            }

            if (bestSolution) {
                optimalSolution = bestSolution;
                displayOptimalSolution(bestSolution);
                
                // C·∫≠p nh·∫≠t input v·ªõi nghi·ªám t·ªëi ∆∞u
                document.getElementById('x1').value = bestSolution.x1;
                document.getElementById('x2').value = bestSolution.x2;
                document.getElementById('x3').value = bestSolution.x3;
            }
        }

        function displayOptimalSolution(solution) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.style.display = 'block';
            
            resultsDiv.innerHTML = `
                <div class="results">
                    <h3>üéâ Nghi·ªám T·ªëi ∆Øu T√¨m ƒê∆∞·ª£c</h3>
                    <div class="solution-table">
                        <table>
                            <tr><th>Bi·∫øn quy·∫øt ƒë·ªãnh</th><th>Gi√° tr·ªã t·ªëi ∆∞u</th><th>√ù nghƒ©a</th></tr>
                            <tr><td><strong>x‚ÇÅ (B·∫£n ng√†y)</strong></td><td>${solution.x1}</td><td>${solution.x1} qu·∫£ng c√°o b·∫£n ng√†y</td></tr>
                            <tr><td><strong>x‚ÇÇ (Tin chi·ªÅu)</strong></td><td>${solution.x2}</td><td>${solution.x2} qu·∫£ng c√°o tin chi·ªÅu</td></tr>
                            <tr><td><strong>x‚ÇÉ (Game Ch·ªß nh·∫≠t)</strong></td><td>${solution.x3}</td><td>${solution.x3} qu·∫£ng c√°o game ch·ªß nh·∫≠t</td></tr>
                            <tr style="background-color: #d4edda;"><td><strong>T·ªïng l∆∞·ª£t ti·∫øp c·∫≠n</strong></td><td>${solution.totalReach.toLocaleString()}</td><td>‚â• ${minReach.toLocaleString()} (ƒê·∫°t y√™u c·∫ßu)</td></tr>
                            <tr style="background-color: #cce5ff;"><td><strong>T·ªïng chi ph√≠ t·ªëi thi·ªÉu</strong></td><td><strong>$${solution.totalCost.toLocaleString()}</strong></td><td>Chi ph√≠ t·ªëi ∆∞u</td></tr>
                        </table>
                    </div>
                    <div style="margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                        <h4>üìä Ph√¢n t√≠ch nghi·ªám:</h4>
                        <ul>
                            <li><strong>Chi ph√≠ trung b√¨nh m·ªói l∆∞·ª£t ti·∫øp c·∫≠n:</strong> $${(solution.totalCost / solution.totalReach).toFixed(4)}</li>
                            <li><strong>Hi·ªáu qu·∫£ nh·∫•t:</strong> ${solution.x1 > 0 ? 'B·∫£n ng√†y' : solution.x2 > 0 ? 'Tin chi·ªÅu' : 'Game Ch·ªß nh·∫≠t'}</li>
                            <li><strong>T·ªïng s·ªë qu·∫£ng c√°o:</strong> ${solution.x1 + solution.x2 + solution.x3} qu·∫£ng c√°o</li>
                        </ul>
                    </div>
                </div>
            `;
        }

        function exportToExcel() {
            // T·∫°o d·ªØ li·ªáu cho Excel
            const wb = XLSX.utils.book_new();
            
            // Sheet 1: Th√¥ng tin b√†i to√°n
            const problemData = [
                ['CASE 3: L·ª∞A CH·ªåN PH∆Ø∆†NG TI·ªÜN TRUY·ªÄN TH√îNG'],
                ['C√¥ng ty SMM - B√†i to√°n t·ªëi ∆∞u h√≥a qu·∫£ng c√°o'],
                [''],
                ['TH√îNG S·ªê B√ÄI TO√ÅN:'],
                ['Lo·∫°i h√¨nh qu·∫£ng c√°o', 'L∆∞·ª£t ti·∫øp c·∫≠n/qu·∫£ng c√°o', 'Chi ph√≠/qu·∫£ng c√°o ($)', 'Gi·ªõi h·∫°n t·ªëi ƒëa'],
                ['B·∫£n ng√†y', 3000, 5000, 10],
                ['Tin chi·ªÅu', 4000, 7000, 6],
                ['Game Ch·ªß nh·∫≠t', 7500, 100000, 5],
                [''],
                ['Y√äU C·∫¶U: T·ªëi thi·ªÉu 11,000,000 l∆∞·ª£t ti·∫øp c·∫≠n'],
                ['M·ª§C TI√äU: T·ªëi thi·ªÉu h√≥a chi ph√≠']
            ];

            // Sheet 2: Nghi·ªám t·ªëi ∆∞u
            const solutionData = [
                ['NGHI·ªÜM T·ªêI ∆ØU'],
                [''],
                ['Bi·∫øn quy·∫øt ƒë·ªãnh', 'Gi√° tr·ªã t·ªëi ∆∞u', '√ù nghƒ©a'],
                ['x1 (B·∫£n ng√†y)', optimalSolution ? optimalSolution.x1 : 'Ch∆∞a t√≠nh', 'S·ªë qu·∫£ng c√°o b·∫£n ng√†y'],
                ['x2 (Tin chi·ªÅu)', optimalSolution ? optimalSolution.x2 : 'Ch∆∞a t√≠nh', 'S·ªë qu·∫£ng c√°o tin chi·ªÅu'],
                ['x3 (Game Ch·ªß nh·∫≠t)', optimalSolution ? optimalSolution.x3 : 'Ch∆∞a t√≠nh', 'S·ªë qu·∫£ng c√°o game ch·ªß nh·∫≠t'],
                [''],
                ['K·∫æT QU·∫¢:'],
                ['T·ªïng l∆∞·ª£t ti·∫øp c·∫≠n', optimalSolution ? optimalSolution.totalReach.toLocaleString() : 'Ch∆∞a t√≠nh', 'l∆∞·ª£t'],
                ['T·ªïng chi ph√≠', optimalSolution ? `$${optimalSolution.totalCost.toLocaleString()}` : 'Ch∆∞a t√≠nh', 'USD'],
                ['Chi ph√≠/l∆∞·ª£t ti·∫øp c·∫≠n', optimalSolution ? `$${(optimalSolution.totalCost / optimalSolution.totalReach).toFixed(6)}` : 'Ch∆∞a t√≠nh', 'USD/l∆∞·ª£t']
            ];

            // Sheet 3: T·∫•t c·∫£ nghi·ªám kh·∫£ thi
            const feasibleSolutions = allSolutions.filter(s => s.totalReach >= minReach);
            const allSolutionsData = [
                ['T·∫§T C·∫¢ NGHI·ªÜM KH·∫¢ THI'],
                [''],
                ['x1', 'x2', 'x3', 'T·ªïng l∆∞·ª£t ti·∫øp c·∫≠n', 'T·ªïng chi ph√≠ ($)', 'Chi ph√≠/l∆∞·ª£t ($)']
            ];
            
            feasibleSolutions
                .sort((a, b) => a.totalCost - b.totalCost)
                .forEach(solution => {
                    allSolutionsData.push([
                        solution.x1,
                        solution.x2, 
                        solution.x3,
                        solution.totalReach,
                        solution.totalCost,
                        (solution.totalCost / solution.totalReach).toFixed(6)
                    ]);
                });

            // T·∫°o c√°c sheet
            const ws1 = XLSX.utils.aoa_to_sheet(problemData);
            const ws2 = XLSX.utils.aoa_to_sheet(solutionData);
            const ws3 = XLSX.utils.aoa_to_sheet(allSolutionsData);

            // Th√™m sheet v√†o workbook
            XLSX.utils.book_append_sheet(wb, ws1, "ƒê·ªÅ b√†i");
            XLSX.utils.book_append_sheet(wb, ws2, "Nghi·ªám t·ªëi ∆∞u");
            XLSX.utils.book_append_sheet(wb, ws3, "T·∫•t c·∫£ nghi·ªám");

            // Xu·∫•t file
            const fileName = `SMM_Optimization_Case3_${new Date().getTime()}.xlsx`;
            XLSX.writeFile(wb, fileName);
            
            alert(`‚úÖ ƒê√£ xu·∫•t file Excel: ${fileName}`);
        }

        // T·ª± ƒë·ªông t√≠nh to√°n khi thay ƒë·ªïi input
        document.addEventListener('DOMContentLoaded', function() {
            const inputs = ['x1', 'x2', 'x3'];
            inputs.forEach(id => {
                document.getElementById(id).addEventListener('input', function() {
                    // T·ª± ƒë·ªông c·∫≠p nh·∫≠t k·∫øt qu·∫£ khi thay ƒë·ªïi
                });
            });
        });
    </script>
</body>
</html>
